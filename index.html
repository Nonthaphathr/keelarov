<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô E-Sports - ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°‡∏ó‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body { font-family: 'Kanit', sans-serif; background: #1a1a1a; color: white; }
        .card { background: #2d2d2d; border: 1px solid #ffd700; box-shadow: 0 0 15px rgba(255, 215, 0, 0.2); }
        .btn-gold { background: linear-gradient(45deg, #FFD700, #FFA500); border: none; font-weight: bold; color: #000; }
        .logo { width: 100px; display: block; margin: 0 auto 20px; }
        a { text-decoration: none; }
        
        /* ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏Å‡∏•‡∏∑‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á */
        label { color: #ffd700; font-weight: 600; margin-bottom: 5px; }
        .form-control, .form-select { background-color: #444; border: 1px solid #666; color: white; }
        .form-control:focus, .form-select:focus { background-color: #555; color: white; border-color: #ffd700; box-shadow: 0 0 5px rgba(255, 215, 0, 0.5); }
        h5 { color: #fff; border-bottom: 2px solid #555; padding-bottom: 10px; margin-top: 20px; }
        .text-muted { color: #ccc !important; } /* ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏µ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÉ‡∏´‡πâ‡∏™‡∏ß‡πà‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô */
    </style>
</head>
<body class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card p-4">
                    <img src="https://nonthaphathr.github.io/uploadimg/logoschool.png" class="logo">
                    <h3 class="text-center mb-4 text-white">‡πÉ‡∏ö‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô E-Sports (ROV)</h3>
                    <h5 class="text-center text-warning" style="border:none;">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏µ‡∏¨‡∏≤‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏∏‡∏°‡∏ó‡∏≠‡∏á‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</h5>
                    <p class="text-center text-muted small">‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ ‡∏Ñ‡∏£‡∏π‡∏ô‡∏ô‡∏ó‡∏û‡∏±‡∏ó‡∏ò‡πå ‡∏´‡∏¥‡∏£‡∏±‡∏ç‡πÄ‡∏£‡∏∑‡∏≠‡∏á</p>
                    
                    <form id="regForm">
                        <h5 class="text-warning">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô (Match Info)</h5>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô</label>
                                <input type="date" class="form-control" id="matchDate" required>
                            </div>
                            <div class="col-md-6">
                                <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏µ‡∏°</label>
                                <select class="form-select" id="teamType" required>
                                    <option value="‡∏ó‡∏µ‡∏°‡∏ä‡∏≤‡∏¢">‡∏ó‡∏µ‡∏°‡∏ä‡∏≤‡∏¢</option>
                                    <option value="‡∏ó‡∏µ‡∏°‡∏´‡∏ç‡∏¥‡∏á">‡∏ó‡∏µ‡∏°‡∏´‡∏ç‡∏¥‡∏á</option>
                                    <option value="‡∏ó‡∏µ‡∏°‡∏ú‡∏™‡∏°">‡∏ó‡∏µ‡∏°‡∏ú‡∏™‡∏°</option>
                                </select>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label>‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô</label>
                            <select class="form-select" id="level" required>
                                <option value="‡∏°.‡∏ï‡πâ‡∏ô">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏ï‡πâ‡∏ô</option>
                                <option value="‡∏°.‡∏õ‡∏•‡∏≤‡∏¢">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏õ‡∏•‡∏≤‡∏¢</option>
                                <option value="‡∏£‡∏ß‡∏°‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏ï‡πâ‡∏ô-‡∏ï‡∏≠‡∏ô‡∏õ‡∏•‡∏≤‡∏¢">‡∏£‡∏ß‡∏°‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡∏≠‡∏ô‡∏ï‡πâ‡∏ô-‡∏ï‡∏≠‡∏ô‡∏õ‡∏•‡∏≤‡∏¢</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label>‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5 ‡∏Ñ‡∏ô) <button type="button" class="btn btn-sm btn-outline-warning ms-2" onclick="addReferee()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°</button></label>
                            <div id="refereeContainer">
                                <input type="text" class="form-control mb-2" name="referee" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• ‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà 1" required>
                            </div>
                        </div>

                        <hr class="border-warning my-4">

                        <h5 class="text-info">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡∏°‡∏ú‡∏π‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£</h5>
                        <div class="mb-3">
                            <label>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ì‡∏∞‡∏™‡∏µ</label>
                            <select class="form-select" id="teamColor" required>
                                <option value="" selected disabled>-- ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏µ --</option>
                                <option value="yellow">‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á</option>
                                <option value="blue">‡∏™‡∏µ‡∏ü‡πâ‡∏≤</option>
                            </select>
                        </div>
                        
                        <label>‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô (‡∏ï‡∏±‡∏ß‡∏à‡∏£‡∏¥‡∏á 5 ‡∏Ñ‡∏ô)</label>
                        <div id="playersContainer">
                            </div>

                        <label class="mt-3">‡∏ï‡∏±‡∏ß‡∏™‡∏≥‡∏£‡∏≠‡∏á <button type="button" class="btn btn-sm btn-outline-light" onclick="addSub()">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°</button></label>
                        <div id="subsContainer"></div>

                        <button type="submit" class="btn btn-gold w-100 mt-4 p-3 fs-5">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£</button>
                    </form>

                    <div class="mt-4 text-center border-top border-secondary pt-3">
                        <p class="text-muted small">‡πÄ‡∏°‡∏ô‡∏π‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà</p>
                        <div class="d-flex justify-content-center gap-2">
                            <a href="match.html" class="btn btn-outline-danger btn-sm">üéÆ ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</a>
                            <a href="report.html" class="btn btn-outline-info btn-sm">üìÑ ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
        import { getDatabase, ref, update } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAAW6t1cnskXOF6mbQTI9jwHQ2FFurkVqo",
            authDomain: "kradumthong-esports.firebaseapp.com",
            databaseURL: "https://kradumthong-esports-default-rtdb.firebaseio.com",
            projectId: "kradumthong-esports",
            storageBucket: "kradumthong-esports.firebasestorage.app",
            messagingSenderId: "297783930970",
            appId: "1:297783930970:web:8addc3c392708a07c52863"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô 5 ‡∏Ñ‡∏ô
        const pContainer = document.getElementById('playersContainer');
        for(let i=1; i<=5; i++){
            pContainer.innerHTML += `<input type="text" class="form-control mb-2" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏µ‡πà ${i}" id="p${i}" required>`;
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏™‡∏≥‡∏£‡∏≠‡∏á
        window.addSub = () => {
            const div = document.createElement('input');
            div.className = "form-control mb-2";
            div.placeholder = "‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• ‡∏ï‡∏±‡∏ß‡∏™‡∏≥‡∏£‡∏≠‡∏á";
            div.name = "subPlayer";
            document.getElementById('subsContainer').appendChild(div);
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£ (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5)
        window.addReferee = () => {
            const container = document.getElementById('refereeContainer');
            const count = container.querySelectorAll('input').length;
            if(count >= 5) return Swal.fire('‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô', '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5 ‡∏Ñ‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö', 'warning');
            
            const input = document.createElement('input');
            input.type = "text";
            input.className = "form-control mb-2";
            input.name = "referee";
            input.placeholder = `‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏• ‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà ${count + 1}`;
            container.appendChild(input);
        }

        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        document.getElementById('regForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            // 1. ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏≤‡∏á (Match Info)
            const matchInfo = {
                date: document.getElementById('matchDate').value,
                level: document.getElementById('level').value,
                type: document.getElementById('teamType').value,
                referees: []
            };
            document.getElementsByName('referee').forEach(el => { if(el.value) matchInfo.referees.push(el.value) });

            // 2. ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡∏° (Team Data)
            const color = document.getElementById('teamColor').value;
            const players = [];
            for(let i=1; i<=5; i++) players.push(document.getElementById(`p${i}`).value);
            const subs = [];
            document.getElementsByName('subPlayer').forEach(el => { if(el.value) subs.push(el.value) });

            const updates = {};
            updates['match_info'] = matchInfo; // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏ó‡∏±‡∏ö‡∏•‡∏á‡πÑ‡∏õ (‡∏ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)
            updates['teams/' + color] = {
                players: players,
                subs: subs,
                timestamp: Date.now()
            };

            update(ref(db), updates).then(() => {
                Swal.fire({
                    title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                    text: `‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡∏°${color == 'yellow' ? '‡∏™‡∏µ‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á' : '‡∏™‡∏µ‡∏ü‡πâ‡∏≤'} ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢`,
                    icon: 'success',
                    confirmButtonColor: '#FFD700'
                });
            }).catch((error) => {
                Swal.fire('Error', error.message, 'error');
            });
        });
    </script>
</body>
</html>
